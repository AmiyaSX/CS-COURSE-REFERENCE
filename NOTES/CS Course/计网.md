## 层
### 1. 应用层(Application Layer)
应用层是工作在操作系统中的用户态，传输层及以下则工作在内核态。

### 2. 传输层(Transport Layer)
为应用层提供网络支持
#### 两个传输协议
1. `TCP` 传输控制协议
	- **可靠传输**
	- TCP 报文头部格式：
	- ![TCP 包头格式 | 500](https://cdn.xiaolincoding.com/gh/xiaolincoder/ImageHost/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C/%E9%94%AE%E5%85%A5%E7%BD%91%E5%9D%80%E8%BF%87%E7%A8%8B/8.jpg)
	- **状态位**：`SYN` 发起一个连接，`ACK` 回复，`RST` 重新连接，`FIN` 结束连接
	- **流量控制**：**窗口大小**
	- **拥塞控制**：
	- **三次握手建立连接**：保证双方都有`发送`和`接收`的能力
2. `UDP`
	 - **非可靠传输**
	 - 

### 3. 网络层(Intnet Layer)
负责将数据从一个设备传输到另一个设备

#### IP 地址(Internet Protocol)
网络号 = **IP地址** AND **子网掩码**
主机号 = **IP地址** AND **子网掩码取反**

**IP 协议的寻址作用是告诉我们去往下一个目的地该朝哪个方向走，路由则是根据「下一个目的地」选择路径。**
- 源地址IP：客户端输出的 IP 地址
- 目标地址：通过 DNS 域名解析得到的 Web 服务器 IP

#### URL
`http:` + `//` + `Web服务器` + `/` + 目录名 + `/` + ... + `filename`

访问数据协议+服务器名+数据源路径名

>如：http://www.server.com/dir1/file1.txt

#### DNS
保存了 `Web` 服务器域名与 `IP` 的对应关系

>如： www.server.com. (`.`根 DNS 服务器，`.com` 顶级域，再下面是 `server.com`)

DNS 域名解析：**只指路不带路**

缓存机制：本地 DNS 服务器

#### TCP
保证可靠传输: 校验和、序列号、超时重传、流量控制及拥塞避免。
三次握手及四次挥手:

##### TCP连接的时候是3次，关闭的时候却是4次
- 确保通信双方都能通知对方释放连接.
断开TCP连接需要客户端和服务端分别通知对方并分别收到确认报文，一共需要四次

##### TCP保活机制
设置TCP保活机制的保活时间keepIdle，即在TCP链接超过该时间没有任何数据交互时，发送保活探测报文；设置保活探测报文的发送时间间隔keepInterval；设置保活探测报文的总发送次数keepCount。如果在keepCount次的保活探测报文均没有收到客户端的回应，则服务器端即关闭与客户端的TCP链接

#### UDP


#### HTTP 与 HTTPS 的区别
![[Pasted image 20221102142637.png]]
#### Session、Cookie和Token的主要区别
- Cookie
客户端会把Cookie存起来，当下次客户端再次请求服务端时，会携带上这个Cookie，服务端会通过这个Cookie来确定身份.

- Session
Session通过Cookie实现，存在服务端。客户端浏览器第一次访问服务器时，服务器会为浏览器创建一个sessionid，将sessionid放到Cookie中，存在客户端浏览器。当浏览器再次访问服务器时，服务器会取出Cookie中的sessionid，并根据sessionid获取会话中的存储的信息。
- Token
#### ARP协议
>实现从IP地址转换为MAC地址。每个主机或者路由器中都建有一个ARP缓存表，表中有IP地址及IP地址对应的MAC地址。

工作流程：
1. 局域网内
	- 首先会在主机A的ARP缓存表中查找是否有IP地址及其对应的MAC地址，如果有，则将MAC地址写入到MAC帧的首部，并通过局域网将该MAC帧发送到MAC地址所在的主机B。
	- 如果主机A的ARP缓存表中没有主机B的IP地址及所对应的MAC地址，主机A会在局域网内广播发送一个ARP请求分组。局域网内的所有主机都会收到这个ARP请求分组。
2. 不在同一个局域网内
	- 即使知道主机B的MAC地址也是不能直接通信的，必须通过路由器转发到主机B的局域网才可以通过主机B的MAC地址找到主机B。
	- 主机H1需要先广播找到路由器R1的MAC地址，再由R1广播找到路由器R2的MAC地址，最后R2广播找到主机H2的MAC地址，建立起通信链路。

##### 为什么还要用MAC地址？
>`IP地址可以比作为地址，MAC地址为收件人，在一次通信过程中，两者是缺一不可的。`
  计算机的IP地址可由用户自行更改，管理起来相对困难，而MAC地址不可更改
>P地址是和地域相关的，对于同一个子网上的设备，IP地址的前缀都是一样的，这样路由器通过IP地址的前缀就知道设备在在哪个子网上了，而只用MAC地址的话，路由器则需要记住每个MAC地址在哪个子网，这需要路由器有极大的存储空间，是无法实现的。

#### ping的过程
>ping是ICMP(网际控制报文协议)中的一个重要应用.
>作用是测试两个主机的连通性

工作过程:
1. 向目的主机发送多个ICMP回送请求报文
2. 根据目的主机返回的回送报文的时间和成功响应的次数估算出数据包往返时间及丢包率

#### 路由器和交换机
- 路由器：网络层。识别IP地址并根据IP地址转发数据包，维护数据表并基于数据表进行最佳路径选择
- 交换机：数据链路层。识别MAC地址并根据MAC地址转发数据帧
#### 浏览器中输⼊url地址到显示主⻚的过程
1. 对输入的url进行DNS解析，将域名转换为IP地址
2. 和目的服务器建立TCP连接
3. 向目的服务器发送HTTP请求
4. 服务器处理请求并返回HTTP报文
5. 浏览器解析并渲染页面

### 4. 网路接口层